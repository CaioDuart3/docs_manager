{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Lista de Documentos</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Arimo:ital,wght@0,400;0,500;0,600;0,700;1,400;1,700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="{% static 'css/global.css' %}" />
    <script src="{% static 'documents/js/search.js' %}" defer></script>
  </head>

  <body>
    <div class="page">
      <!-- logout -->
      <form class="logout-button" method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button type="submit">Sair da conta</button>
      </form>

      <div class="container">
        <div class="container-title-upload">
          <div>
            <div class="container-logo">
              <img
                src="{% static 'img/logo.svg' %}"
                alt="Logo do Sistema de Documentos"
              />
            </div>
            <div class="container-title">
              <h1>Lista de documentos</h1>
              <h2>Gerencie seus arquivos e documentos</h2>
            </div>
          </div>

          <!-- Botão de upload -->
          <a href="{% url 'documents_upload' %}">
            <div class="button">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 20 20"
                fill="none"
              >
                <path
                  d="M10 2.5V12.5"
                  stroke="white"
                  stroke-width="1.66667"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M14.1666 6.66667L9.99998 2.5L5.83331 6.66667"
                  stroke="white"
                  stroke-width="1.66667"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <path
                  d="M17.5 12.5V15.8333C17.5 16.2754 17.3244 16.6993 17.0118 17.0118C16.6993 17.3244 16.2754 17.5 15.8333 17.5H4.16667C3.72464 17.5 3.30072 17.3244 2.98816 17.0118C2.67559 16.6993 2.5 16.2754 2.5 15.8333V12.5"
                  stroke="white"
                  stroke-width="1.66667"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              Upload Document
            </div>
          </a>
        </div>
        <!-- Barra de pesquisa -->
        <div class="input-group">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 20 20"
              fill="none"
            >
              <path
                d="M17.5 17.5L13.8833 13.8834"
                stroke="#99A1AF"
                stroke-width="1.66667"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path
                d="M9.16667 15.8333C12.8486 15.8333 15.8333 12.8486 15.8333 9.16667C15.8333 5.48477 12.8486 2.5 9.16667 2.5C5.48477 2.5 2.5 5.48477 2.5 9.16667C2.5 12.8486 5.48477 15.8333 9.16667 15.8333Z"
                stroke="#99A1AF"
                stroke-width="1.66667"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          <input
            type="text"
            name="search"
            placeholder="Buscador de documentos"
            id="search"
          />
        </div>

        <p class="documents-count">
          {{ documents.count}} documento(s) encontrado(s).
        </p>

        <div class="container-cards-document">
          {% for document in documents %}
          <div class="card-document">
            <div class="card-info">
                <a href="{% url 'documents_details' document.pk %}">
                    <img src="{% static 'img/icon-document.svg' %}" alt="Thumbnail" />
                </a>
              <div class="card-info-texts">
                <a id="title-document" href="{% url 'documents_details' document.pk %}"><b>{{ document.title }}</b> publicado por <b>{{ document.author }}</b></a>
                <div class="card-info-texts-details">
                  <p>{{document.file_extension}}</p>
                  <p>{{document.get_file_size_display}}</p>
                  <p>{{ document.uploaded_at|date:"d/m/Y H:i" }}</p>
                </div>
              </div>
            </div>
            <div class="card-icons">
              <!-- icone de visualizar -->
              <a href="{% url 'documents_details' document.pk %}">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 20 20"
                  fill="none"
                >
                  <path
                    d="M1.71835 10.2901C1.6489 10.103 1.6489 9.89715 1.71835 9.71006C2.39476 8.06993 3.54294 6.66759 5.01732 5.6808C6.4917 4.69402 8.22588 4.16724 10 4.16724C11.7741 4.16724 13.5083 4.69402 14.9827 5.6808C16.4571 6.66759 17.6053 8.06993 18.2817 9.71006C18.3511 9.89715 18.3511 10.103 18.2817 10.2901C17.6053 11.9302 16.4571 13.3325 14.9827 14.3193C13.5083 15.3061 11.7741 15.8329 10 15.8329C8.22588 15.8329 6.4917 15.3061 5.01732 14.3193C3.54294 13.3325 2.39476 11.9302 1.71835 10.2901Z"
                    stroke="#4A5565"
                    stroke-width="1.66667"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M10 12.5C11.3807 12.5 12.5 11.3807 12.5 10C12.5 8.61929 11.3807 7.5 10 7.5C8.61929 7.5 7.5 8.61929 7.5 10C7.5 11.3807 8.61929 12.5 10 12.5Z"
                    stroke="#4A5565"
                    stroke-width="1.66667"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </a>

              <!-- icone de baixar -->
              <a href="{{ document.file.url }}" download>
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 20 20"
                  fill="none"
                >
                  <path
                    d="M10 12.5V2.5"
                    stroke="#4A5565"
                    stroke-width="1.66667"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M17.5 12.5V15.8333C17.5 16.2754 17.3244 16.6993 17.0118 17.0118C16.6993 17.3244 16.2754 17.5 15.8333 17.5H4.16667C3.72464 17.5 3.30072 17.3244 2.98816 17.0118C2.67559 16.6993 2.5 16.2754 2.5 15.8333V12.5"
                    stroke="#4A5565"
                    stroke-width="1.66667"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                  <path
                    d="M5.83337 8.33337L10 12.5L14.1667 8.33337"
                    stroke="#4A5565"
                    stroke-width="1.66667"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
              </a>

              <!-- Botão de exclusão - Apenas se o usuário tiver permissão -->
              {% if document.author == current_user or current_user.is_staff or current_user.is_superuser %}
              <form
                method="POST"
                action="{% url 'documents_delete' document.pk %}"
                style="display: inline"
              >
                {% csrf_token %}
                <button
                  type="submit"
                  style="all: unset; cursor: pointer"
                  onclick="
                    return confirm(
                      'Tem certeza que deseja deletar este documento?',
                    );
                  "
                >
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="20"
                    height="20"
                    viewBox="0 0 20 20"
                    fill="none"
                  >
                    <path
                      d="M8.33337 9.16663V14.1666"
                      stroke="#E7000B"
                      stroke-width="1.66667"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M11.6666 9.16663V14.1666"
                      stroke="#E7000B"
                      stroke-width="1.66667"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M15.8333 5V16.6667C15.8333 17.1087 15.6577 17.5326 15.3451 17.8452C15.0326 18.1577 14.6087 18.3333 14.1666 18.3333H5.83329C5.39127 18.3333 4.96734 18.1577 4.65478 17.8452C4.34222 17.5326 4.16663 17.1087 4.16663 16.6667V5"
                      stroke="#E7000B"
                      stroke-width="1.66667"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M2.5 5H17.5"
                      stroke="#E7000B"
                      stroke-width="1.66667"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                    <path
                      d="M6.66663 4.99996V3.33329C6.66663 2.89127 6.84222 2.46734 7.15478 2.15478C7.46734 1.84222 7.89127 1.66663 8.33329 1.66663H11.6666C12.1087 1.66663 12.5326 1.84222 12.8451 2.15478C13.1577 2.46734 13.3333 2.89127 13.3333 3.33329V4.99996"
                      stroke="#E7000B"
                      stroke-width="1.66667"
                      stroke-linecap="round"
                      stroke-linejoin="round"
                    />
                  </svg>
                </button>
              </form>
              {% endif %}

              <!-- Número de comentários -->
              <div class="icon-comments-counts">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none"
                >
                  <path
                    d="M1.99462 10.8946C2.09265 11.1419 2.11447 11.4128 2.05729 11.6726L1.34729 13.866C1.32441 13.9772 1.33033 14.0924 1.36447 14.2007C1.39862 14.309 1.45987 14.4068 1.5424 14.4848C1.62494 14.5628 1.72603 14.6184 1.83609 14.6464C1.94615 14.6744 2.06153 14.6738 2.17129 14.6446L4.44662 13.9793C4.69177 13.9307 4.94564 13.9519 5.17929 14.0406C6.60288 14.7054 8.21553 14.8461 9.73272 14.4378C11.2499 14.0295 12.5741 13.0984 13.4718 11.8089C14.3694 10.5193 14.7827 8.95423 14.6388 7.38966C14.4949 5.82509 13.8031 4.3616 12.6853 3.25742C11.5676 2.15324 10.0958 1.47932 8.52955 1.35456C6.96333 1.2298 5.40338 1.66221 4.12492 2.57552C2.84646 3.48882 1.93164 4.82432 1.54189 6.34638C1.15213 7.86845 1.31247 9.47926 1.99462 10.8946Z"
                    stroke="#5D5FEF"
                    stroke-width="1.33333"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  />
                </svg>
                <p>{{ document.comments.count }}</p>
              </div>
              <!-- Botões de ação -->
            </div>
          </div>

          {% empty %}
          <p>Sem documentos disponíveis.</p>
          {% endfor %}
        </div>
      </div>
    </div>
  </body>
</html>
